ymq_define("Validate",["jquery","Config","Upload"],(function(r,e,o){return class a{constructor(){var r=this;r.instance=null,r.dom=null,r.config=e.getInstance(),r.upload=o.getInstance(),r.init()}initMemberVariables(){var e=this;e.selectDom=null,e.selectValueArray=[],e.selectValue="",e.domErrorArray=[],e.validateCount=0,e.validateArray=[],e.validateValue=[],e.form=r(e.config.form_box)}init(){this.initMemberVariables()}doValidate(){var e=this,o=e.selectDom.parents(".ymq-options-box");e.domErrorArray=[];var a=0,t=99999;e.validateArray.forEach((function(r){r.search("min_s:")>-1&&(a=Number(r.split(":")[1])),r.search("max_s:")>-1&&(t=Number(r.split(":")[1]))})),0==a&&0==t||(a==t?(e.selectValueArray.length>t-1?r(`#${o.prop("id")} input:checkbox:not([data-title]):not(:checked)`).prop("disabled",!0):r(`#${o.prop("id")} input:checkbox:not([data-title]):not(:checked)`).prop("disabled",!1),e.selectValueArray.length!=a&&(e.config.ymq_option_branding.lan.hasOwnProperty("total_s")?e.domErrorArray.push(e.config.ymq_option_branding.lan.total_s.replace("%s",a)):e.domErrorArray.push("You need to choose "+a+"."))):(e.selectValueArray.length<a&&(e.config.ymq_option_branding.lan.hasOwnProperty("min_s")?e.domErrorArray.push(e.config.ymq_option_branding.lan.min_s.replace("%s",a)):e.domErrorArray.push("You need to choose more than "+a+".")),e.selectValueArray.length>t&&(e.config.ymq_option_branding.lan.hasOwnProperty("max_s")?e.domErrorArray.push(e.config.ymq_option_branding.lan.max_s.replace("%s",t)):e.domErrorArray.push("You need to choose less than "+t+".")),e.selectValueArray.length>t-1?r(`#${o.prop("id")} input:checkbox:not([data-title]):not(:checked)`).prop("disabled",!0):r(`#${o.prop("id")} input:checkbox:not([data-title]):not(:checked)`).prop("disabled",!1))),e.validateArray.forEach((function(o){"required"==o&&(e.json.hasOwnProperty("isFile")?e.upload.fileData.hasOwnProperty(e.json.name)?r.isEmptyObject(e.upload.fileData[e.json.name])&&e.domErrorArray.push(e.config.ymq_option_branding.lan.require):e.domErrorArray.push(e.config.ymq_option_branding.lan.require):""==e.selectValue&&e.domErrorArray.push(e.config.ymq_option_branding.lan.require)),""!=e.selectValue&&(o.search("minchar:")>-1&&e.selectValue.length<o.split(":")[1]&&e.domErrorArray.push(e.config.ymq_option_branding.lan.min_char.replace("%s",o.split(":")[1])),o.search("maxchar:")>-1&&e.selectValue.length>o.split(":")[1]&&e.domErrorArray.push(e.config.ymq_option_branding.lan.max_char.replace("%s",o.split(":")[1])),o.search("min:")>-1&&Number(e.selectValue)<Number(o.split(":")[1])&&e.domErrorArray.push(e.config.ymq_option_branding.lan.min.replace("%s",o.split(":")[1])),o.search("max:")>-1&&Number(e.selectValue)>Number(o.split(":")[1])&&e.domErrorArray.push(e.config.ymq_option_branding.lan.max.replace("%s",o.split(":")[1])),"email"!=o||e.config.emailRe.test(e.selectValue)||e.domErrorArray.push(e.config.ymq_option_branding.lan.email),"integer"==o&&e.selectValue%1!=0&&e.domErrorArray.push(e.config.ymq_option_branding.lan.integer),"number"!=o||e.config.numberRe.test(e.selectValue)||e.domErrorArray.push(e.config.ymq_option_branding.lan.number),o.search("float:")>-1&&e.selectValue%1!=0&&e.selectValue.toString().split(".")[1].length>o.split(":")[1]&&e.domErrorArray.push(`${o.split(":")[1]}小数`))}))}validateOne(e,o=!1){var a=this;if(a.json=e,e&&e.validate){a.validateArray=e.validate.split("|"),a.selectDom=e.dom,a.selectValueArray=e.value,a.selectValue=e.value.join(","),a.doValidate();var t="";if(a.domErrorArray.length){a.domErrorArray.forEach((function(r){t+=`\n\t\t\t\t\t\t\t<div class="ymq-error-item">${r}</div>\n\t\t\t\t\t\t`}));var n=e.dom.parents(".ymq-options-box");if(0==a.validateCount&&o){if(n.offset().top+n.outerHeight()<r(window).scrollTop()){var i=n.offset().top-200;r("html, body").animate({scrollTop:i},500)}e.dom.focus()}a.validateCount++,e.dom.parents(".ymq-options-box").find("textarea").addClass("ymq_error_border"),e.dom.parents(".ymq-options-box").find(".selectDropdown").find("span").addClass("ymq_error_border"),e.dom.parents(".ymq-options-box").find("input[type='text']").addClass("ymq_error_border")}else e.dom.parents(".ymq-options-box").find("textarea").removeClass("ymq_error_border"),e.dom.parents(".ymq-options-box").find(".selectDropdown").find("span").removeClass("ymq_error_border"),e.dom.parents(".ymq-options-box").find("input[type='text']").removeClass("ymq_error_border");e.dom.parents(".ymq-options-box").find(".ymq-error-box").html(t)}}validateAll(r,e=!1){var o=this;o.validateCount=0,Object.keys(r).forEach((function(a){o.validateOne(r[a],e)}))}require(){}testValidate(r){r?this.success():this.error()}success(){}error(){this.dom.addClass("ymq_error")}static getInstance(){return this.instance||(this.instance=new a),this.instance}}}));